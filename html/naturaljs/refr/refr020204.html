<article class="refr020204 apiDoc">
    <h1>
        <span lang="ko_KR">예제</span>
        <span lang="en_US">Examples</span>
    </h1>

    <h3 lang="ko_KR" class="notIndex">1. AOP 선언</h3>
    <h3 lang="en_US" class="notIndex">1. AOP declaration</h3>
    <ul>
        <li lang="ko_KR">AOP 설정은 natural.config.js 파일의 N.context.attr("architecture").cont 속성에 설정합니다.</li>
        <li lang="en_US">The AOP setting is set in the N.context.attr("architecture").cont property of the natural.config.js file.</li>
    </ul>
    <pre><code>N.context.attr("architecture", {
    ...
    "cont" : {
        "pointcuts" : {
            "regexp" : {
                "fn" : function(param, cont, fnChain){
                    var regexp = param instanceof RegExp ? param : new RegExp(param);
                    return regexp.test(fnChain);
                }
            },
            "errorPointcut" : {
                "fn" : function(param, cont, fnChain){
                    // Unconditionally allowed
                    return true;
                }
            }
        },
        "advisors" : [{
            "pointcut" : "^before.*",
            "adviceType" : "before",
            "fn" : function(cont, fnChain, args){
                console.log("call me before %s", fnChain);
            }
        }, {
            "pointcut" : "^after.*",
            "adviceType" : "after",
            "fn" : function(cont, fnChain, args, result){
                console.log("call me after %s", fnChain);
                console.log("reuslt", result);
            }
        }, {
            "pointcut" : "^around.*",
            "adviceType" : "around",
            "fn" : function(cont, fnChain, args, joinPoint){
                console.log("call me around %s", fnChain);
                var result = joinPoint.proceed();
                console.log("result ", result);
                return result;
            }
        }, {
            "pointcut" : {
                "type" : "errorPointcut",
                "param" : ""
            },
            "adviceType" : "error",
            "fn" : function(cont, fnChain, args, result, e) {
                console.log("call me error %s", fnChain);
            }
        }]
    },
    ...
}</code></pre>

    <h3 lang="ko_KR" class="notIndex">2. 모든 페이지에 공통코드를 불러와 N.select 컴포넌트로 요소들에 바인딩한 후 Controller object의 init을 지연 실행하기</h3>
    <h3 lang="en_US" class="notIndex">2. Load common code on all pages, bind to elements with N.select component, and delay init of the Controller object</h3>
    <pre lang="ko_KR"><code>N.context.attr("architecture", {
    ...
    "cont" : {
        "advisors" : [{
            "pointcut" : "^init$",
            "adviceType" : "around",
            "fn" : function(cont, fnChain, args, joinPoint){
                // 1. 공통코드 데이터 가져오기
                N.comm("getCommCodeList.json").submit(function(data) {
                    // 2. N.select로 선택 요소에 공통코드 바인딩
                    N(data).select({
                        context : N("#select", cont.view)
                    }).bind()

                    // 3. init 함수 실행.
                    joinPoint.proceed();
                });
            }
        }]
    },
    ...
}</code></pre>
    <pre lang="en_US"><code>N.context.attr("architecture", {
    ...
    "cont" : {
        "advisors" : [{
            "pointcut" : "^init$",
            "adviceType" : "around",
            "fn" : function(cont, fnChain, args, joinPoint){
                // 1. Common code data load
                N.comm("getCommCodeList.json").submit(function(data) {
                    // 2. Bind common code to selection   elements with N.select
                    N(data).select({
                        context : N("#select", cont.view)
                    }).bind()

                    // 3. Execute init function.
                    joinPoint.proceed();
                });
            }
        }]
    },
    ...
}</code></pre>

    <h3 lang="ko_KR" class="notIndex">3. 로드된 페이지의 버튼, 폼, 그리드, 리스트 컴포넌트들을 자동으로 초기화해 준 후에 init 함수 실행하기.</h3>
    <h3 lang="en_US" class="notIndex">3. Executing the init function after automatically initializing the button, form, grid, and list components of the loaded page.</h3>
    <pre lang="ko_KR"><code>N.context.attr("architecture", {
    ...
    "cont" : {
        "advisors" : [{
            "pointcut" : "^init$",
            "adviceType" : "around",
            "fn" : function(cont, fnChain, args, joinPoint){
                // 1. 버튼 컴포넌트 초기화
                N(".button").button();

                // 2. 폼 컴포넌트 초기화
                N(".form", cont.view).each(function() {
                    N([]).form(this);
                })

                // 3. 리스트 컴포넌트 초기화
                N(".list", cont.view).each(function() {
                    N([]).list(this);
                })

                // 4. 그리드 컴포넌트 초기화
                N(".grid", cont.view).each(function() {
                    N([]).grid(this);
                })

                // 5. init 함수 실행.
                joinPoint.proceed();

                // 6. 이후에 각 컴포넌트의 인스턴스는 context에서 꺼내와서 사용.
                var grid01 = N("#grid01", cont.view).instance("grid"); // Natural-CORE의 instance 메서드 참고.
                grid01.bind([]);
            }
        }]
    },
    ...
}</code></pre>
    <pre lang="en_US"><code>N.context.attr("architecture", {
    ...
    "cont" : {
        "advisors" : [{
            "pointcut" : "^init$",
            "adviceType" : "around",
            "fn" : function(cont, fnChain, args, joinPoint){
                // 1. Button component initialization
                N(".button").button();

                // 2. Form component initialization
                N(".form", cont.view).each(function() {
                    N([]).form(this);
                })

                // 3. List component initialization
                N(".list", cont.view).each(function() {
                    N([]).list(this);
                })

                // 4. Grid component initialization
                N(".grid", cont.view).each(function() {
                    N([]).grid(this);
                })

                // 5. Execute init function.
                joinPoint.proceed();

                // 6. After this, each component instance is taken from the context and used.
                var grid01 = N("#grid01", cont.view).instance("grid"); // See the instance method of Natural-CORE.
                grid01.bind([]);
            }
        }]
    },
    ...
}</code></pre>
</article>

<script type="text/javascript">
N(".refr020204").cont({
    init : function(view, request) {

    }
});
</script>