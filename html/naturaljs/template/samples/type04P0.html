<article class="type04P0 view-code" title="부서조회" style="width: 400px;">
    <div class="view-intro">
        <span lang="ko_KR">부서 검색 팝업</span>
        <span lang="en_US">Department Search Popup</span>
        <ul class="view-desc">
            <li>조회폼(N.form)과 그리드(N.grid)로 구성된 팝업 예제입니다.</li>
            <li>N.popup의 onOpen, cont.close 함수 들의 사용예제를 참고할 수 있습니다.</li>
        </ul>
    </div>

    <div id="search" class="form__">
        <div class="search-panel">
            <ul>
                <li><label><span>Department Name</span><input id="deptNm" type="text"></label></li>
            </ul>
        </div>
    </div>

    <div class="button-panel">
        <button id="btnSearch" data-opts='{ "color": "primary" }'>조회</button>
    </div>

    <table id="master" class="grid__">
        <colgroup>
            <col style="width: 30%;">
            <col style="width: auto;">
        </colgroup>
        <thead>
            <tr>
                <th>Code</th>
                <th>Name</th>
            </tr>
        </thead>
        <tbody>
            <tr id="row">
                <td id="deptCd" style="text-align: center;"></td>
                <td id="deptNm" style="text-align: center;"></td>
            </tr>
        </tbody>
    </table>

    <div class="button-panel">
        <button id="btnOk" data-opts='{ "color": "primary" }'>확인</button>
        <button id="btnCancel">취소</button>
    </div>

</article>

<script type="text/javascript">
(function() {

    var cont = N(".type04P0").cont({
        "p.form.search" : {
            "usage" : "search-box"
        },
        "p.grid.master" : {
            height : 300,
            select : true,
            onBind : function(context, data) {
                if (data.length == 1) {
                    this.select(0);
                    cont["e.btnOk.click"].trigger("click");
                }
            }
        },
        "c.getSampleDeptList" : function() {
            cont["p.form.search"].val("isList", true);
            return cont["p.form.search"].data(false).comm("sample/getSampleDeptList.json");
        },
        "e.btnSearch.click" : function(e) {
            e.preventDefault();
            if (cont["p.form.search"].validate()) {
                cont["c.getSampleDeptList"]().submit(function(data) {
                    // N.grid bind
                    cont["p.grid.master"].bind(data);
                });
            }
        },
        "e.btnOk.click" : function(e) {
            e.preventDefault();
            cont.caller.close(cont["p.grid.master"].data()[cont["p.grid.master"].select()]);
        },
        "e.btnCancel.click" : function(e) {
            e.preventDefault();
            cont.caller.close();
        },
        "e.row.dblclick" : function(e) {
            cont["e.btnOk.click"].trigger("click");
        },
        init : function(view, request) {
            cont["e.btnSearch.click"].trigger("click");
        },
        onOpen : function(onOpenData) {
        }
    });

})();
</script>