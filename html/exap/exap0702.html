<article class="exap0702 view-code" >
	<table id="detail" class="form" style="width: 100%;">
		<tr>
			<th rowspan="5" style="width: 15%;" align="right">picture</th>
			<td rowspan="5" style="width: 35%;" align="center" valign="middle"><img id="picture" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D" height="170" /></td>
			<th style="width: 15%;"><label for="name">Name</label></th>
			<td style="width: 35%;"><input id="name" type="text" data-validate='[["required"]]' /></td>
		</tr>
		<tr>
			<th><label for="email">Email</label></th>
			<td><input id="email" type="text" data-validate='[["required"], ["email"]]' /></td>
		</tr>
		<tr>
			<th><label for="key">Password</label></th>
			<td><input id="key" type="text" data-format='[["generic", "@@＊＊＊＊＊＊"]]' data-validate='[["required"]]' /></td>
		</tr>
		<tr>
			<th><label for="balance">Balance</label></th>
			<td><input id="balance" type="text" data-format='[["numeric", "$#,###.##0"]]' data-validate='[["required"], ["number"]]' /></td>
		</tr>
		<tr>
			<th><label for="phone">Phone</label></th>
			<td><input id="phone" type="text" data-validate='[["required"]]' /></td>
		</tr>
		<tr>
			<th><label for="age">Age</label></th>
			<td><input id="age" type="text" data-validate='[["required"], ["integer"]]' /></td>
			<th><label for="eyeColor">Eye color</label></th>
			<td>
				<select id="eyeColor" data-validate='[["required"]]'>
					<option>선택</option>
				</select>
			</td>
		</tr>
		<tr>
			<th rowspan="3"><label for="company">Company</label></th>
			<td rowspan="3"><select id="company" multiple="multiple" data-validate='[["required"]]' style="height: 117px;"></select></td>
			<th><label for="gender">Gender</label></th>
			<td><input id="gender" type="radio" /></td>
		</tr>
		<tr>
			<th><label for="favoriteFruit">Favorite fruit</label></th>
			<td><input id="favoriteFruit" type="checkbox" /></td>
		</tr>
		<tr>
			<th><label for="registered">Registered</label></th>
			<td><input id="registered" type="text" data-format='[["date", 8, "date"]]' data-validate='[["required"]]' /></td>
		</tr>
		<tr>
			<th><label for="about">About</label></th>
			<td colspan="3"><textarea id="about" style="width: 95%;" rows="3" data-format='[["limit", "100", "..."]]' data-validate='[["required"]]'></textarea></td>
		</tr>
		<tr>
			<th><label for="greeting">Greeting</label></th>
			<td colspan="3"><textarea id="greeting" style="width: 95%;" rows="2"></textarea></td>
		</tr>
		<tr>
			<th><label for="isActive">Active</label></th>
			<td colspan="3"><input id="isActive" type="checkbox" /></td>
		</tr>
	</table>
	<div class="buttons" align="center">
		<a id="btnConfirm" href="#" data-opts='{ "color" : "gray" }'>확인</a>
		<a id="btnCancel" href="#">취소</a>
	</div>
</article>

<script type="text/javascript">
N(".exap0702").cont({
	genderCodes: [{
    	"key" : "male",
    	"val" : "male"
	    },{
	    	"key" : "female",
	    	"val" : "female"
	}],
	eyeColorCodes: [{
	    	"key" : "blue",
	    	"val" : "blue"
	    },{
	    	"key" : "brown",
	    	"val" : "brown"
	    },{
	    	"key" : "green",
	    	"val" : "green"
	}],
	companyCodes: [{
	    	"key" : "PROSELY",
	    	"val" : "PROSELY"
	    },{
	    	"key" : "ASSISTIX",
	    	"val" : "ASSISTIX"
	    },{
	    	"key" : "VORATAK",
	    	"val" : "VORATAK"
	    },{
	    	"key" : "CANDECOR",
	    	"val" : "CANDECOR"
	    },{
	    	"key" : "BARKARAMA",
	    	"val" : "BARKARAMA"
	    },{
	    	"key" : "STOCKPOST",
	    	"val" : "STOCKPOST"
	    },{
	    	"key" : "MICROLUXE",
	    	"val" : "MICROLUXE"
	    },{
	    	"key" : "SHADEASE",
	    	"val" : "SHADEASE"
	    },{
	    	"key" : "ZENTIA",
	    	"val" : "ZENTIA"
		},{
	    	"key" : "INTRADISK",
	    	"val" : "INTRADISK"
	}],
	favoriteFruitCodes: [{
	    	"key" : "apple",
	    	"val" : "apple"
	    },{
	    	"key" : "strawberry",
	    	"val" : "strawberry"
	    },{
	    	"key" : "banana",
	    	"val" : "banana"
	}],
    init : function(view, request) {
    	var editMode = this.request.attr("mode");
		if(this.request.attr("caller") !== undefined) {
			this.caller = this.request.attr("caller");
		}

    	// 1. initialize buttons
    	N(".buttons a", view).button();

    	// 2. initialize N.select and bind select data
    	// 2-1. create #gender select
		N(this.genderCodes).select(N("#detail #gender", view)).bind().val("male");
		// 2-2. create #eyeColor select
		N(this.eyeColorCodes).select(N("#detail #eyeColor", view)).bind();
		// 2-3. create #company select
		N(this.companyCodes).select(N("#detail #company", view)).bind();
		// 2-4. create #favoriteFruit select
		N(this.favoriteFruitCodes).select(N("#detail #favoriteFruit", view)).bind();

    	// 3. initialize N.form
    	var form = this.request.attr("selData").data.form({
    		context : N("#detail", view),
    		addTop : true,
    		revert : true
    	});
    	if(editMode === "create") {
    		// 3-1. Create mode - add data
    		form.add();
		} else {
			// 3-1. Edit mode - bind data
			form.bind(this.request.attr("selData").row, this.request.attr("selData").data);
		}

    	// 4. bind events
    	// 4-1 Confirm button
    	N("#btnConfirm", view).click(function(e) {
            e.preventDefault();
            if(form.validate()) {
            	caller.close()
            }
        });
    	// 4-2 Cancel button - Revert data & close this popup
    	// this.caller is popup instance that called this page
    	var caller = this.caller;
    	N("#btnCancel", view).click(function(e) {
    		e.preventDefault();
    		if(editMode === "create") {
				// remove created row
    			form.remove();
    		} else {
		    	form.revert();
    		}
    		caller.close()
    	});
    }
});
</script>