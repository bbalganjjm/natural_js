/*
 Natural-TEMPLATE v0.4.11

 Released under the LGPL v2.1 license
 Date: 2019-02-28T18:00Z

 Copyright 2023 KIM HWANG MAN(bbalganjjm@gmail.com)
*/
(function(x,r){N.version["Natural-TEMPLATE"]="0.4.11";(function(c){var u=c.template={aop:{codes:function(b,g){var e={codeUrl:null,codeKey:null};try{r.extend(!0,e,c.context.attr("template").aop.codes)}catch(h){throw c.error("N.template.aop.codes",h);}var d=[],f=[],m=[],a;for(a in b)"string"===c.type(a)&&c.string.startsWith(a,"p.select.")&&("array"===c.type(b[a])&&0<b[a].length&&(b[a]=2<b[a].length?{comm:b[a][0],key:b[a][1],val:b[a][2],filter:b[a][3]}:{code:b[a][0],filter:b[a][1]}),b[a].code?d.push(a.split(".")[2]+
"|"+b[a].code):b[a].comm?f.push(a.split(".")[2]+"|"+b[a].comm):m.push(a.split(".")[2]+"|select__"));0<m.length&&c(m).each(function(h,k){h=k.split("|");var l=b["p.select."+h[0]];if(l.data)b["p.select."+h[0]]=c("[id='"+h[0]+"']",b.view).filter("select,input[type='checkbox'],input[type='radio']").map(function(q,p){l.context=p;l.filter&&(l.data=l.filter(l.data));q=c().select(l).bind();l.selected&&q.val(l.selected);return q}).get();else throw c.error(c.message.get(c.context.attr("template").message,"MSG-0001"));
});if(0<d.length||0<f.length){var n=[];0<d.length&&(m=c(d).map(function(h,k){return k.split("|")[1]}).get(),n.push(c({codes:null!=m&&0===m.length?void 0:m}).comm({url:e.codeUrl}).submit(function(h){c(d).each(function(k,l){var q=l.split("|"),p=b["p.select."+q[0]];b["p.select."+q[0]]=c("[id='"+q[0]+"']",b.view).filter("select,input[type='checkbox'],input[type='radio']").map(function(t,v){p.context=v;t=r.grep(h,function(w){return w[e.codeKey]===q[1]});t=c(p.filter?p.filter(t):t).select(p).bind();p.selected&&
t.val(p.selected);return t}).get()})}).error(function(h){c.warn(h);throw c.error(c.message.get(c.context.attr("template").message,"MSG-0002"));}).request.obj.xhr));c(f).each(function(h,k){var l=k.split("|");if(!b[l[1]])throw c.error(c.message.get(c.context.attr("template").message,"MSG-0003",[l[1]]));n.push(b[l[1]]().submit(function(q){var p=b["p.select."+l[0]];b["p.select."+l[0]]=c("[id='"+l[0]+"']",b.view).filter("select,input[type='checkbox'],input[type='radio']").map(function(t,v){p.context=v;
t=c(p.filter?p.filter(q):q).select(p).bind();p.selected&&t.val(p.selected);return t}).get()}).error(function(q){c.warn(q);throw c.error(c.message.get(c.context.attr("template").message,"MSG-0004",[l[0]]));}).request.obj.xhr)});r.when.apply(r,n).done(function(){u.aop.template(b,g)})}else u.aop.template(b,g)},template:function(b,g){var e={onBeforeInitComponents:null,onInitComponents:null,onBeforeInitEvents:null,onInitEvents:null};try{r.extend(!0,e,c.context.attr("template").aop.template)}catch(m){throw c.error("N.template.aop.template",
m);}e.onBeforeInitComponents&&e.onBeforeInitComponents.call(this,b,g);var d=[],f;for(f in b)"string"===c.type(f)&&c.string.startsWith(f,"p.")&&u.aop.components(b,f,d);e.onBeforeInitEvents&&e.onBeforeInitEvents.call(this,b,g);for(f in b)"string"===c.type(f)&&c.string.startsWith(f,"e.")&&u.aop.events(b,f);e.onInitEvents&&e.onInitEvents.call(this,b,g);0<d.length&&(r(d).each(function(){this.resolve();e.onInitComponents&&e.onInitComponents.call(this,b,g)}),d=void 0);g.proceed();setTimeout(function(){b.onOpenDefer&&
b.onOpenDefer.resolve()},0)},components:function(b,g,e){var d=g.split(".");if(2<d.length){var f="p."+d[1]+"."+d[2],m=c("#"+d[2],b.view),a=b[f];void 0!==a&&void 0!==a.context&&(m=c(a.context,b.view));"popup"===d[1]&&"file"===d[2]&&(a.url="file/manager.view",a.top=20,a.onOpen="onOpen",a.overlayClose=!1,a.escClose=!1);if(void 0===a||0===m.length&&void 0===a.context&&0===m.length&&void 0===a.url)throw c.error(c.message.get(c.context.attr("template").message,"MSG-0005",[b.view.data("pageid")+":"+g]));
a.context=m;"button"===d[1]||"popup"===d[1]||"tab"===d[1]||"datepicker"===d[1]?((a.url&&"popup"===d[1]||"tab"===d[1])&&void 0===a.opener&&(a.opener=b),b[f]=a.context[d[1]](a)):"select"===d[1]||a.code||(b[f]=c([])[d[1]](a));if(a.usage){var n={"search-box":{defaultButton:".btn-search",events:[]}};"object"===c.type(a.usage)&&r.extend(!0,n,a.usage);if("search-box"===a.usage||void 0!==n["search-box"]){a.context.addClass("search_box__");void 0!==a.action&&"add"===a.action||b[f].add();var h=[];g=n["search-box"].events;
0<g.length&&r(g).each(function(){h.push(this.target);a.context.find(this.target).on(this.event+"."+b.view.data("pageid"),this.handler)});a.context.on("keyup."+b.view.data("pageid"),":input:not("+h.join(",")+")",function(k){13==(k.keyCode?k.keyCode:k.which?k.which:k.charCode)&&b.view.find(n["search-box"].defaultButton).trigger("click")});if(c.browser.is("ie"))a.context.on("keyup."+b.view.data("pageid"),":input",function(k){13==(k.keyCode?k.keyCode:k.which?k.which:k.charCode)&&this.blur()})}}a.action&&
e.push(r.Deferred().done(function(){if("string"===c.type(a.action))b[f][a.action]();else"array"===c.type(a.action)&&1<a.action.length&&b[f][a.action[0]].apply(b[f],a.action.splice(1))}))}else throw c.error(c.message.get(c.context.attr("template").message,"MSG-0005",[b.view.data("pageid")+":"+g]));},events:function(b,g){var e=g.split(".");if(2<e.length){var d=e[2],f="";if("function"===typeof b[g]){e=e[1];var m=b[g];f="#"}else if("object"===c.type(b[g]))e=b[g].target,m=b[g].handler;else throw c.error(c.message.get(c.context.attr("template").message,
"MSG-0006",[b.view.data("pageid")+":"+g]));var a=c(f+e,b.view);if(0<a.length){var n=a.closest(".list__, .grid__"),h;0<n.length&&0===a.closest("header").length?(n.hasClass("list__")?h=n.instance("list"):n.hasClass("grid__")&&(h=n.instance("grid")),h&&(a=h.tempRowEle.find(f+e),a.is(":radio, :checkbox")&&1<c("[name='"+e+"']",h.tempRowEle).length&&(a=c("[name='"+e+"']",h.tempRowEle)))):a.is(":radio, :checkbox")&&1<c("[name='"+e+"']",b.view).length&&(a=c("[name='"+e+"']",b.view));a.is("a, button, input[type=button]")?
a.button():d&&-1<d.indexOf("click")&&a.css("cursor","pointer");h?(f=a.is(":radio")||a.is(":checkbox")&&1<a.length?">.form__ [name='"+e+"']:radio, >.form__ [name='"+e+"']:checkbox":">.form__ "+f+e,b[g]=n.on(d+"."+b.view.data("pageid"),f,function(){var k=Array.apply(null,arguments);k.push(n.find(">.form__").index(r(this).closest(".form__")));m.apply(this,k)})):b[g]=a.on(d+"."+b.view.data("pageid"),m)}}else throw c.error(c.message.get(c.context.attr("template").message,"MSG-0006",[b.view.data("pageid")+
":"+g]));}}}})(N)})(window,jQuery);
